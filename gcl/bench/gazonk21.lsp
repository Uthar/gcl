
(lisp::defun compiler::match (compiler::pat compiler::dat compiler::alist) (lisp::cond ((lisp::null compiler::pat) (lisp::null compiler::dat)) ((lisp::null compiler::dat) lisp::nil) ((lisp::or (lisp::eq (lisp::car compiler::pat) (lisp::quote compiler::?)) (lisp::eq (lisp::car compiler::pat) (lisp::car compiler::dat))) (compiler::match (lisp::cdr compiler::pat) (lisp::cdr compiler::dat) compiler::alist)) ((lisp::eq (lisp::car compiler::pat) (lisp::quote lisp::*)) (lisp::or (compiler::match (lisp::cdr compiler::pat) compiler::dat compiler::alist) (compiler::match (lisp::cdr compiler::pat) (lisp::cdr compiler::dat) compiler::alist) (compiler::match compiler::pat (lisp::cdr compiler::dat) compiler::alist))) (lisp::t (lisp::cond ((lisp::atom (lisp::car compiler::pat)) (lisp::cond ((lisp::eql (compiler::browse-char1 (lisp::car compiler::pat)) compiler::*browse-questionmark*) (lisp::let ((compiler::val (lisp::assoc (lisp::car compiler::pat) compiler::alist))) (lisp::cond (compiler::val (compiler::match (lisp::cons (lisp::cdr compiler::val) (lisp::cdr compiler::pat)) compiler::dat compiler::alist)) (lisp::t (compiler::match (lisp::cdr compiler::pat) (lisp::cdr compiler::dat) (lisp::cons (lisp::cons (lisp::car compiler::pat) (lisp::car compiler::dat)) compiler::alist)))))) ((lisp::eql (compiler::browse-char1 (lisp::car compiler::pat)) compiler::*browse-star*) (lisp::let ((compiler::val (lisp::assoc (lisp::car compiler::pat) compiler::alist))) (lisp::cond (compiler::val (compiler::match (lisp::append (lisp::cdr compiler::val) (lisp::cdr compiler::pat)) compiler::dat compiler::alist)) (lisp::t (lisp::do ((compiler::l lisp::nil (lisp::nconc compiler::l (lisp::cons (lisp::car compiler::d) lisp::nil))) (compiler::e (lisp::cons lisp::nil compiler::dat) (lisp::cdr compiler::e)) (compiler::d compiler::dat (lisp::cdr compiler::d))) ((lisp::null compiler::e) lisp::nil) (lisp::cond ((compiler::match (lisp::cdr compiler::pat) compiler::d (lisp::cons (lisp::cons (lisp::car compiler::pat) compiler::l) compiler::alist)) (lisp::return lisp::t)))))))))) (lisp::t (lisp::and (lisp::not (lisp::atom (lisp::car compiler::dat))) (compiler::match (lisp::car compiler::pat) (lisp::car compiler::dat) compiler::alist) (compiler::match (lisp::cdr compiler::pat) (lisp::cdr compiler::dat) compiler::alist)))))))